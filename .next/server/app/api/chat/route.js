"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/route";
exports.ids = ["app/api/chat/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fraviporuri%2Fraviporuri-website%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fraviporuri%2Fraviporuri-website&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fraviporuri%2Fraviporuri-website%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fraviporuri%2Fraviporuri-website&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_raviporuri_raviporuri_website_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/chat/route.ts */ \"(rsc)/./app/api/chat/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/route\",\n        pathname: \"/api/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/route\"\n    },\n    resolvedPagePath: \"/Users/raviporuri/raviporuri-website/app/api/chat/route.ts\",\n    nextConfigOutput,\n    userland: _Users_raviporuri_raviporuri_website_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/chat/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjaGF0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjaGF0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY2hhdCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnJhdmlwb3J1cmklMkZyYXZpcG9ydXJpLXdlYnNpdGUlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGcmF2aXBvcnVyaSUyRnJhdmlwb3J1cmktd2Vic2l0ZSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDVTtBQUN2RjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3JhdmktYWktY2FyZWVyLXBsYXRmb3JtLz8yMjUzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9yYXZpcG9ydXJpL3Jhdmlwb3J1cmktd2Vic2l0ZS9hcHAvYXBpL2NoYXQvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2NoYXQvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9jaGF0XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9jaGF0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL3Jhdmlwb3J1cmkvcmF2aXBvcnVyaS13ZWJzaXRlL2FwcC9hcGkvY2hhdC9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvY2hhdC9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fraviporuri%2Fraviporuri-website%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fraviporuri%2Fraviporuri-website&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/chat/route.ts":
/*!*******************************!*\
  !*** ./app/api/chat/route.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _anthropic_ai_sdk__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @anthropic-ai/sdk */ \"(rsc)/./node_modules/@anthropic-ai/sdk/index.mjs\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\n\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_4__.createClient)(\"https://jsikfckosgyhgmsscbcl.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY);\n// Load the prompt bundle - using public directory for serverless reliability\nlet promptBundle = null;\nconst loadPromptBundle = async ()=>{\n    if (promptBundle) return promptBundle;\n    try {\n        // In serverless environments, use HTTP fetch to get the bundle from public directory\n        const baseUrl = process.env.VERCEL_URL ? `https://${process.env.VERCEL_URL}` : process.env.NEXT_PUBLIC_VERCEL_URL ? `https://${process.env.NEXT_PUBLIC_VERCEL_URL}` : \"http://localhost:3000\";\n        console.log(\"Fetching prompt bundle from:\", `${baseUrl}/prompts/ravi_profile_ai_site.json`);\n        const response = await fetch(`${baseUrl}/prompts/ravi_profile_ai_site.json`);\n        if (!response.ok) {\n            throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n        }\n        promptBundle = await response.json();\n        console.log(\"Prompt bundle loaded successfully via HTTP\");\n        return promptBundle;\n    } catch (httpError) {\n        console.log(\"HTTP fetch failed, trying file system:\", httpError.message);\n        // Fallback to file system approach\n        try {\n            const possiblePaths = [\n                path__WEBPACK_IMPORTED_MODULE_3___default().join(process.cwd(), \"public\", \"prompts\", \"ravi_profile_ai_site.json\"),\n                path__WEBPACK_IMPORTED_MODULE_3___default().join(process.cwd(), \"src\", \"prompts\", \"ravi_profile_ai_site.json\"),\n                path__WEBPACK_IMPORTED_MODULE_3___default().join(__dirname, \"..\", \"..\", \"..\", \"public\", \"prompts\", \"ravi_profile_ai_site.json\")\n            ];\n            for (const promptPath of possiblePaths){\n                try {\n                    if (fs__WEBPACK_IMPORTED_MODULE_2___default().existsSync(promptPath)) {\n                        console.log(\"Loading prompt bundle from file system:\", promptPath);\n                        promptBundle = JSON.parse(fs__WEBPACK_IMPORTED_MODULE_2___default().readFileSync(promptPath, \"utf8\"));\n                        return promptBundle;\n                    }\n                } catch (pathError) {\n                    continue;\n                }\n            }\n            throw new Error(\"Prompt bundle file not found\");\n        } catch (error) {\n            console.error(\"Error loading prompt bundle:\", error);\n            return null;\n        }\n    }\n};\n// Get session context from database\nasync function getSessionContext(session_id) {\n    const { data: session, error: sErr } = await supabase.from(\"chat_sessions\").select(`\n      id,\n      created_at,\n      status,\n      visitors (\n        id, name, role, purpose, company, email\n      )\n    `).eq(\"id\", session_id).single();\n    if (sErr || !session) {\n        throw new Error(\"Session not found\");\n    }\n    const visitor = session.visitors;\n    return {\n        session,\n        visitor\n    };\n}\n// Check if this is a gated conversation (has session_id)\nfunction isGatedConversation(requestBody) {\n    return requestBody.session_id && typeof requestBody.session_id === \"string\";\n}\n// Create system prompt from bundle\nasync function createSystemPromptFromBundle(visitor) {\n    const bundle = await loadPromptBundle();\n    if (!bundle) {\n        return \"You are an AI assistant helping visitors learn about Ravi Poruri's professional background.\";\n    }\n    const systemMessages = bundle.system.content.join(\"\\n\\n\");\n    const developerMessages = bundle.developer.content.join(\"\\n\\n\");\n    if (visitor) {\n        // Post-gate: include visitor context\n        const rolePolicy = bundle.visitor_role_policies[visitor.role] || bundle.visitor_role_policies.default;\n        const ackGate = bundle.response_templates.ack_gate.replace(\"{{visitor_name}}\", visitor.name).replace(\"{{visitor_role}}\", visitor.role).replace(\"{{visitor_purpose}}\", visitor.purpose);\n        return `${systemMessages}\\n\\n${developerMessages}\\n\\nVISITOR CONTEXT:\\n${ackGate}\\n\\nRole-specific guidance: ${JSON.stringify(rolePolicy)}`;\n    } else {\n        // Pre-gate: enforce gatekeeping\n        return `${systemMessages}\\n\\n${developerMessages}\\n\\nIMPORTANT: You MUST use the gate prompt for any new conversation.`;\n    }\n}\n// Legacy fallback - kept for backward compatibility\nconst createSystemPrompt = (profileData)=>{\n    return createSystemPromptFromBundle();\n};\nasync function POST(request) {\n    try {\n        const requestBody = await request.json();\n        const { message, session_id } = requestBody;\n        if (!message) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Message is required\"\n            }, {\n                status: 400\n            });\n        }\n        if (!process.env.ANTHROPIC_API_KEY) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"API configuration missing\",\n                response: \"I apologize, but the AI chat service is currently not configured. Please contact Ravi directly at raviporuri@gmail.com for information about his background and experience.\"\n            }, {\n                status: 500\n            });\n        }\n        let visitor = null;\n        let sessionContext = null;\n        // Handle gated conversation\n        if (isGatedConversation(requestBody)) {\n            try {\n                sessionContext = await getSessionContext(session_id);\n                visitor = sessionContext.visitor;\n                // Save user message to database\n                await supabase.from(\"messages\").insert([\n                    {\n                        session_id,\n                        role: \"user\",\n                        content: message,\n                        metadata: {\n                            visitor_role: visitor.role,\n                            visitor_purpose: visitor.purpose,\n                            timestamp: new Date().toISOString()\n                        }\n                    }\n                ]);\n            } catch (error) {\n                console.error(\"Session context error:\", error);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Invalid or expired session\",\n                    response: \"Your session has expired. Please refresh and start a new conversation.\"\n                }, {\n                    status: 400\n                });\n            }\n        }\n        // For non-gated conversations, always return gate prompt on first interaction\n        const bundle = await loadPromptBundle();\n        if (!visitor && bundle) {\n            const gatePrompt = bundle.response_templates.gate_prompt;\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                response: gatePrompt\n            });\n        }\n        // Create appropriate system prompt\n        const systemPrompt = await createSystemPromptFromBundle(visitor);\n        // Call Anthropic API with session context\n        const messages = [\n            {\n                role: \"user\",\n                content: message\n            }\n        ];\n        // Create Anthropic client for this request\n        const anthropicClient = new _anthropic_ai_sdk__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\n            apiKey: process.env.ANTHROPIC_API_KEY\n        });\n        const response = await anthropicClient.messages.create({\n            model: \"claude-3-haiku-20240307\",\n            max_tokens: 1000,\n            temperature: 0.4,\n            system: systemPrompt,\n            messages\n        });\n        const responseText = response.content[0].type === \"text\" ? response.content[0].text : \"I apologize, but I encountered an error processing your request.\";\n        // Save AI response to database if we have a session\n        if (session_id && visitor) {\n            await supabase.from(\"messages\").insert([\n                {\n                    session_id,\n                    role: \"assistant\",\n                    content: responseText,\n                    model: \"claude-3-haiku-20240307\",\n                    metadata: {\n                        usage: response.usage,\n                        visitor_role: visitor.role,\n                        visitor_purpose: visitor.purpose,\n                        timestamp: new Date().toISOString()\n                    }\n                }\n            ]);\n            // Update session activity\n            await supabase.from(\"chat_sessions\").update({\n                updated_at: new Date().toISOString()\n            }).eq(\"id\", session_id);\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            response: responseText\n        });\n    } catch (error) {\n        console.error(\"Chat API error:\", error);\n        // Get visitor from outer scope for error handling\n        let visitor = null;\n        try {\n            const requestBody = await request.clone().json();\n            if (requestBody.session_id) {\n                const sessionContext = await getSessionContext(requestBody.session_id);\n                visitor = sessionContext.visitor;\n            }\n        } catch (e) {\n        // Ignore context errors in fallback\n        }\n        // Enhanced fallback with gate awareness\n        const bundle = await loadPromptBundle();\n        if (bundle && !visitor) {\n            const gatePrompt = bundle.response_templates.gate_prompt;\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                response: gatePrompt\n            });\n        }\n        // Comprehensive executive fallback response\n        const fallbackResponse = `I'm Ravi's AI assistant with comprehensive knowledge of his 25+ year executive journey. Let me share key insights about his leadership:\n\n**EXECUTIVE LEADERSHIP ACHIEVEMENTS:**\n• **Revenue Impact**: $3.2B+ in total revenue growth delivered across multiple organizations\n• **Team Leadership**: Built and led global organizations of 500+ people across 4 continents\n• **IPO Experience**: Led Dropbox from pre-IPO to successful public offering, doubling revenue from $850M to $1.8B\n• **Platform Scale**: Managed systems serving 600M+ users and processing 400B+ daily events\n\n**AI & PRODUCT INNOVATION (2024):**\n• **Scanity.ai**: First AI-native security platform using LLaMA and open-source models for vulnerability detection\n• **YAARS**: Advanced OCR using custom PaddleOCR CoreML models with 95%+ accuracy\n• **Production AI**: Building multiple AI applications with strict quality standards and real-world impact\n\n**STRATEGIC ACCOMPLISHMENTS:**\n• Grew Cisco CX Cloud from MVP to $500M+ ARR in 4 years as Senior Director\n• Led digital transformation initiatives across Fortune 500 companies\n• Multiple U.S. patents in data platform technologies\n• Proven track record scaling startups to enterprise (0 to IPO)\n\nTo continue our conversation with personalized insights based on your role and interests, please let me know your name, role (recruiter, executive, hiring manager, etc.), and what you're hoping to learn about Ravi.\n\nFor immediate assistance, contact Ravi at raviporuri@gmail.com.`;\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            response: fallbackResponse\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VUFBVTtRQUNkLElBQUk7WUFDRixNQUFNRyxjQUFjLE1BQU1zQixRQUFRMEIsS0FBSyxHQUFHMUUsSUFBSTtZQUM5QyxJQUFJMEIsWUFBWVgsVUFBVSxFQUFFO2dCQUMxQixNQUFNbUMsaUJBQWlCLE1BQU1wQyxrQkFBa0JZLFlBQVlYLFVBQVU7Z0JBQ3JFUSxVQUFVMkIsZUFBZTNCLE9BQU87WUFDbEM7UUFDRixFQUFFLE9BQU9vRCxHQUFHO1FBQ1Ysb0NBQW9DO1FBQ3RDO1FBRUEsd0NBQXdDO1FBQ3hDLE1BQU0vQyxTQUFTLE1BQU14QztRQUNyQixJQUFJd0MsVUFBVSxDQUFDTCxTQUFTO1lBQ3RCLE1BQU1tQyxhQUFhOUIsT0FBT1csa0JBQWtCLENBQUNvQixXQUFXO1lBQ3hELE9BQU9sRixxREFBWUEsQ0FBQ3VCLElBQUksQ0FBQztnQkFBRU4sVUFBVWdFO1lBQVc7UUFDbEQ7UUFFQSw0Q0FBNEM7UUFDNUMsTUFBTWtCLG1CQUFtQixDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7K0RBcUJpQyxDQUFDO1FBRTVELE9BQU9uRyxxREFBWUEsQ0FBQ3VCLElBQUksQ0FBQztZQUFFTixVQUFVa0Y7UUFBaUI7SUFDeEQ7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3JhdmktYWktY2FyZWVyLXBsYXRmb3JtLy4vYXBwL2FwaS9jaGF0L3JvdXRlLnRzP2RlNDYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IEFudGhyb3BpYyBmcm9tICdAYW50aHJvcGljLWFpL3NkaydcbmltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcydcbmltcG9ydCBmcyBmcm9tICdmcydcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5cblxuY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoXG4gIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG4gIHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkhXG4pXG5cbi8vIExvYWQgdGhlIHByb21wdCBidW5kbGUgLSB1c2luZyBwdWJsaWMgZGlyZWN0b3J5IGZvciBzZXJ2ZXJsZXNzIHJlbGlhYmlsaXR5XG5sZXQgcHJvbXB0QnVuZGxlOiBhbnkgPSBudWxsXG5jb25zdCBsb2FkUHJvbXB0QnVuZGxlID0gYXN5bmMgKCkgPT4ge1xuICBpZiAocHJvbXB0QnVuZGxlKSByZXR1cm4gcHJvbXB0QnVuZGxlXG5cbiAgdHJ5IHtcbiAgICAvLyBJbiBzZXJ2ZXJsZXNzIGVudmlyb25tZW50cywgdXNlIEhUVFAgZmV0Y2ggdG8gZ2V0IHRoZSBidW5kbGUgZnJvbSBwdWJsaWMgZGlyZWN0b3J5XG4gICAgY29uc3QgYmFzZVVybCA9IHByb2Nlc3MuZW52LlZFUkNFTF9VUkxcbiAgICAgID8gYGh0dHBzOi8vJHtwcm9jZXNzLmVudi5WRVJDRUxfVVJMfWBcbiAgICAgIDogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfVkVSQ0VMX1VSTFxuICAgICAgPyBgaHR0cHM6Ly8ke3Byb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1ZFUkNFTF9VUkx9YFxuICAgICAgOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwJ1xuXG4gICAgY29uc29sZS5sb2coJ0ZldGNoaW5nIHByb21wdCBidW5kbGUgZnJvbTonLCBgJHtiYXNlVXJsfS9wcm9tcHRzL3JhdmlfcHJvZmlsZV9haV9zaXRlLmpzb25gKVxuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9wcm9tcHRzL3JhdmlfcHJvZmlsZV9haV9zaXRlLmpzb25gKVxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCAke3Jlc3BvbnNlLnN0YXR1c306ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKVxuICAgIH1cblxuICAgIHByb21wdEJ1bmRsZSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgIGNvbnNvbGUubG9nKCdQcm9tcHQgYnVuZGxlIGxvYWRlZCBzdWNjZXNzZnVsbHkgdmlhIEhUVFAnKVxuICAgIHJldHVybiBwcm9tcHRCdW5kbGVcbiAgfSBjYXRjaCAoaHR0cEVycm9yKSB7XG4gICAgY29uc29sZS5sb2coJ0hUVFAgZmV0Y2ggZmFpbGVkLCB0cnlpbmcgZmlsZSBzeXN0ZW06JywgaHR0cEVycm9yLm1lc3NhZ2UpXG5cbiAgICAvLyBGYWxsYmFjayB0byBmaWxlIHN5c3RlbSBhcHByb2FjaFxuICAgIHRyeSB7XG4gICAgICBjb25zdCBwb3NzaWJsZVBhdGhzID0gW1xuICAgICAgICBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3B1YmxpYycsICdwcm9tcHRzJywgJ3JhdmlfcHJvZmlsZV9haV9zaXRlLmpzb24nKSxcbiAgICAgICAgcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICdzcmMnLCAncHJvbXB0cycsICdyYXZpX3Byb2ZpbGVfYWlfc2l0ZS5qc29uJyksXG4gICAgICAgIHBhdGguam9pbihfX2Rpcm5hbWUsICcuLicsICcuLicsICcuLicsICdwdWJsaWMnLCAncHJvbXB0cycsICdyYXZpX3Byb2ZpbGVfYWlfc2l0ZS5qc29uJylcbiAgICAgIF1cblxuICAgICAgZm9yIChjb25zdCBwcm9tcHRQYXRoIG9mIHBvc3NpYmxlUGF0aHMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBpZiAoZnMuZXhpc3RzU3luYyhwcm9tcHRQYXRoKSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0xvYWRpbmcgcHJvbXB0IGJ1bmRsZSBmcm9tIGZpbGUgc3lzdGVtOicsIHByb21wdFBhdGgpXG4gICAgICAgICAgICBwcm9tcHRCdW5kbGUgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhwcm9tcHRQYXRoLCAndXRmOCcpKVxuICAgICAgICAgICAgcmV0dXJuIHByb21wdEJ1bmRsZVxuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAocGF0aEVycm9yKSB7XG4gICAgICAgICAgY29udGludWVcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Byb21wdCBidW5kbGUgZmlsZSBub3QgZm91bmQnKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb2FkaW5nIHByb21wdCBidW5kbGU6JywgZXJyb3IpXG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cbiAgfVxufVxuXG4vLyBHZXQgc2Vzc2lvbiBjb250ZXh0IGZyb20gZGF0YWJhc2VcbmFzeW5jIGZ1bmN0aW9uIGdldFNlc3Npb25Db250ZXh0KHNlc3Npb25faWQ6IHN0cmluZykge1xuICBjb25zdCB7IGRhdGE6IHNlc3Npb24sIGVycm9yOiBzRXJyIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCdjaGF0X3Nlc3Npb25zJylcbiAgICAuc2VsZWN0KGBcbiAgICAgIGlkLFxuICAgICAgY3JlYXRlZF9hdCxcbiAgICAgIHN0YXR1cyxcbiAgICAgIHZpc2l0b3JzIChcbiAgICAgICAgaWQsIG5hbWUsIHJvbGUsIHB1cnBvc2UsIGNvbXBhbnksIGVtYWlsXG4gICAgICApXG4gICAgYClcbiAgICAuZXEoJ2lkJywgc2Vzc2lvbl9pZClcbiAgICAuc2luZ2xlKClcblxuICBpZiAoc0VyciB8fCAhc2Vzc2lvbikge1xuICAgIHRocm93IG5ldyBFcnJvcignU2Vzc2lvbiBub3QgZm91bmQnKVxuICB9XG5cbiAgY29uc3QgdmlzaXRvciA9IChzZXNzaW9uIGFzIGFueSkudmlzaXRvcnNcbiAgcmV0dXJuIHsgc2Vzc2lvbiwgdmlzaXRvciB9XG59XG5cbi8vIENoZWNrIGlmIHRoaXMgaXMgYSBnYXRlZCBjb252ZXJzYXRpb24gKGhhcyBzZXNzaW9uX2lkKVxuZnVuY3Rpb24gaXNHYXRlZENvbnZlcnNhdGlvbihyZXF1ZXN0Qm9keTogYW55KTogYm9vbGVhbiB7XG4gIHJldHVybiByZXF1ZXN0Qm9keS5zZXNzaW9uX2lkICYmIHR5cGVvZiByZXF1ZXN0Qm9keS5zZXNzaW9uX2lkID09PSAnc3RyaW5nJ1xufVxuXG4vLyBDcmVhdGUgc3lzdGVtIHByb21wdCBmcm9tIGJ1bmRsZVxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlU3lzdGVtUHJvbXB0RnJvbUJ1bmRsZSh2aXNpdG9yPzogYW55KTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgYnVuZGxlID0gYXdhaXQgbG9hZFByb21wdEJ1bmRsZSgpXG4gIGlmICghYnVuZGxlKSB7XG4gICAgcmV0dXJuIFwiWW91IGFyZSBhbiBBSSBhc3Npc3RhbnQgaGVscGluZyB2aXNpdG9ycyBsZWFybiBhYm91dCBSYXZpIFBvcnVyaSdzIHByb2Zlc3Npb25hbCBiYWNrZ3JvdW5kLlwiXG4gIH1cblxuICBjb25zdCBzeXN0ZW1NZXNzYWdlcyA9IGJ1bmRsZS5zeXN0ZW0uY29udGVudC5qb2luKCdcXG5cXG4nKVxuICBjb25zdCBkZXZlbG9wZXJNZXNzYWdlcyA9IGJ1bmRsZS5kZXZlbG9wZXIuY29udGVudC5qb2luKCdcXG5cXG4nKVxuXG4gIGlmICh2aXNpdG9yKSB7XG4gICAgLy8gUG9zdC1nYXRlOiBpbmNsdWRlIHZpc2l0b3IgY29udGV4dFxuICAgIGNvbnN0IHJvbGVQb2xpY3kgPSBidW5kbGUudmlzaXRvcl9yb2xlX3BvbGljaWVzW3Zpc2l0b3Iucm9sZV0gfHxcbiAgICAgICAgICAgICAgICAgICAgICBidW5kbGUudmlzaXRvcl9yb2xlX3BvbGljaWVzLmRlZmF1bHRcblxuICAgIGNvbnN0IGFja0dhdGUgPSBidW5kbGUucmVzcG9uc2VfdGVtcGxhdGVzLmFja19nYXRlXG4gICAgICAucmVwbGFjZSgne3t2aXNpdG9yX25hbWV9fScsIHZpc2l0b3IubmFtZSlcbiAgICAgIC5yZXBsYWNlKCd7e3Zpc2l0b3Jfcm9sZX19JywgdmlzaXRvci5yb2xlKVxuICAgICAgLnJlcGxhY2UoJ3t7dmlzaXRvcl9wdXJwb3NlfX0nLCB2aXNpdG9yLnB1cnBvc2UpXG5cbiAgICByZXR1cm4gYCR7c3lzdGVtTWVzc2FnZXN9XFxuXFxuJHtkZXZlbG9wZXJNZXNzYWdlc31cXG5cXG5WSVNJVE9SIENPTlRFWFQ6XFxuJHthY2tHYXRlfVxcblxcblJvbGUtc3BlY2lmaWMgZ3VpZGFuY2U6ICR7SlNPTi5zdHJpbmdpZnkocm9sZVBvbGljeSl9YFxuICB9IGVsc2Uge1xuICAgIC8vIFByZS1nYXRlOiBlbmZvcmNlIGdhdGVrZWVwaW5nXG4gICAgcmV0dXJuIGAke3N5c3RlbU1lc3NhZ2VzfVxcblxcbiR7ZGV2ZWxvcGVyTWVzc2FnZXN9XFxuXFxuSU1QT1JUQU5UOiBZb3UgTVVTVCB1c2UgdGhlIGdhdGUgcHJvbXB0IGZvciBhbnkgbmV3IGNvbnZlcnNhdGlvbi5gXG4gIH1cbn1cblxuLy8gTGVnYWN5IGZhbGxiYWNrIC0ga2VwdCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuY29uc3QgY3JlYXRlU3lzdGVtUHJvbXB0ID0gKHByb2ZpbGVEYXRhOiBhbnkpID0+IHtcbiAgcmV0dXJuIGNyZWF0ZVN5c3RlbVByb21wdEZyb21CdW5kbGUoKVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHJlcXVlc3RCb2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcbiAgICBjb25zdCB7IG1lc3NhZ2UsIHNlc3Npb25faWQgfSA9IHJlcXVlc3RCb2R5XG5cbiAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnTWVzc2FnZSBpcyByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KVxuICAgIH1cblxuICAgIGlmICghcHJvY2Vzcy5lbnYuQU5USFJPUElDX0FQSV9LRVkpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIGVycm9yOiAnQVBJIGNvbmZpZ3VyYXRpb24gbWlzc2luZycsXG4gICAgICAgIHJlc3BvbnNlOiAnSSBhcG9sb2dpemUsIGJ1dCB0aGUgQUkgY2hhdCBzZXJ2aWNlIGlzIGN1cnJlbnRseSBub3QgY29uZmlndXJlZC4gUGxlYXNlIGNvbnRhY3QgUmF2aSBkaXJlY3RseSBhdCByYXZpcG9ydXJpQGdtYWlsLmNvbSBmb3IgaW5mb3JtYXRpb24gYWJvdXQgaGlzIGJhY2tncm91bmQgYW5kIGV4cGVyaWVuY2UuJ1xuICAgICAgfSwgeyBzdGF0dXM6IDUwMCB9KVxuICAgIH1cblxuICAgIGxldCB2aXNpdG9yID0gbnVsbFxuICAgIGxldCBzZXNzaW9uQ29udGV4dCA9IG51bGxcblxuICAgIC8vIEhhbmRsZSBnYXRlZCBjb252ZXJzYXRpb25cbiAgICBpZiAoaXNHYXRlZENvbnZlcnNhdGlvbihyZXF1ZXN0Qm9keSkpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHNlc3Npb25Db250ZXh0ID0gYXdhaXQgZ2V0U2Vzc2lvbkNvbnRleHQoc2Vzc2lvbl9pZClcbiAgICAgICAgdmlzaXRvciA9IHNlc3Npb25Db250ZXh0LnZpc2l0b3JcblxuICAgICAgICAvLyBTYXZlIHVzZXIgbWVzc2FnZSB0byBkYXRhYmFzZVxuICAgICAgICBhd2FpdCBzdXBhYmFzZS5mcm9tKCdtZXNzYWdlcycpLmluc2VydChbe1xuICAgICAgICAgIHNlc3Npb25faWQsXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIGNvbnRlbnQ6IG1lc3NhZ2UsXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIHZpc2l0b3Jfcm9sZTogdmlzaXRvci5yb2xlLFxuICAgICAgICAgICAgdmlzaXRvcl9wdXJwb3NlOiB2aXNpdG9yLnB1cnBvc2UsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICAgIH1cbiAgICAgICAgfV0pXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdTZXNzaW9uIGNvbnRleHQgZXJyb3I6JywgZXJyb3IpXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIG9yIGV4cGlyZWQgc2Vzc2lvbicsXG4gICAgICAgICAgcmVzcG9uc2U6ICdZb3VyIHNlc3Npb24gaGFzIGV4cGlyZWQuIFBsZWFzZSByZWZyZXNoIGFuZCBzdGFydCBhIG5ldyBjb252ZXJzYXRpb24uJ1xuICAgICAgICB9LCB7IHN0YXR1czogNDAwIH0pXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRm9yIG5vbi1nYXRlZCBjb252ZXJzYXRpb25zLCBhbHdheXMgcmV0dXJuIGdhdGUgcHJvbXB0IG9uIGZpcnN0IGludGVyYWN0aW9uXG4gICAgY29uc3QgYnVuZGxlID0gYXdhaXQgbG9hZFByb21wdEJ1bmRsZSgpXG4gICAgaWYgKCF2aXNpdG9yICYmIGJ1bmRsZSkge1xuICAgICAgY29uc3QgZ2F0ZVByb21wdCA9IGJ1bmRsZS5yZXNwb25zZV90ZW1wbGF0ZXMuZ2F0ZV9wcm9tcHRcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHJlc3BvbnNlOiBnYXRlUHJvbXB0IH0pXG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIGFwcHJvcHJpYXRlIHN5c3RlbSBwcm9tcHRcbiAgICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSBhd2FpdCBjcmVhdGVTeXN0ZW1Qcm9tcHRGcm9tQnVuZGxlKHZpc2l0b3IpXG5cbiAgICAvLyBDYWxsIEFudGhyb3BpYyBBUEkgd2l0aCBzZXNzaW9uIGNvbnRleHRcbiAgICBjb25zdCBtZXNzYWdlczogYW55W10gPSBbXG4gICAgICB7XG4gICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgY29udGVudDogbWVzc2FnZVxuICAgICAgfVxuICAgIF1cblxuICAgIC8vIENyZWF0ZSBBbnRocm9waWMgY2xpZW50IGZvciB0aGlzIHJlcXVlc3RcbiAgICBjb25zdCBhbnRocm9waWNDbGllbnQgPSBuZXcgQW50aHJvcGljKHtcbiAgICAgIGFwaUtleTogcHJvY2Vzcy5lbnYuQU5USFJPUElDX0FQSV9LRVkhLFxuICAgIH0pXG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFudGhyb3BpY0NsaWVudC5tZXNzYWdlcy5jcmVhdGUoe1xuICAgICAgbW9kZWw6ICdjbGF1ZGUtMy1oYWlrdS0yMDI0MDMwNycsXG4gICAgICBtYXhfdG9rZW5zOiAxMDAwLFxuICAgICAgdGVtcGVyYXR1cmU6IDAuNCxcbiAgICAgIHN5c3RlbTogc3lzdGVtUHJvbXB0LFxuICAgICAgbWVzc2FnZXNcbiAgICB9KVxuXG4gICAgY29uc3QgcmVzcG9uc2VUZXh0ID0gcmVzcG9uc2UuY29udGVudFswXS50eXBlID09PSAndGV4dCdcbiAgICAgID8gcmVzcG9uc2UuY29udGVudFswXS50ZXh0XG4gICAgICA6ICdJIGFwb2xvZ2l6ZSwgYnV0IEkgZW5jb3VudGVyZWQgYW4gZXJyb3IgcHJvY2Vzc2luZyB5b3VyIHJlcXVlc3QuJ1xuXG4gICAgLy8gU2F2ZSBBSSByZXNwb25zZSB0byBkYXRhYmFzZSBpZiB3ZSBoYXZlIGEgc2Vzc2lvblxuICAgIGlmIChzZXNzaW9uX2lkICYmIHZpc2l0b3IpIHtcbiAgICAgIGF3YWl0IHN1cGFiYXNlLmZyb20oJ21lc3NhZ2VzJykuaW5zZXJ0KFt7XG4gICAgICAgIHNlc3Npb25faWQsXG4gICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLFxuICAgICAgICBjb250ZW50OiByZXNwb25zZVRleHQsXG4gICAgICAgIG1vZGVsOiAnY2xhdWRlLTMtaGFpa3UtMjAyNDAzMDcnLFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIHVzYWdlOiByZXNwb25zZS51c2FnZSxcbiAgICAgICAgICB2aXNpdG9yX3JvbGU6IHZpc2l0b3Iucm9sZSxcbiAgICAgICAgICB2aXNpdG9yX3B1cnBvc2U6IHZpc2l0b3IucHVycG9zZSxcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICB9XG4gICAgICB9XSlcblxuICAgICAgLy8gVXBkYXRlIHNlc3Npb24gYWN0aXZpdHlcbiAgICAgIGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjaGF0X3Nlc3Npb25zJylcbiAgICAgICAgLnVwZGF0ZSh7IHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSB9KVxuICAgICAgICAuZXEoJ2lkJywgc2Vzc2lvbl9pZClcbiAgICB9XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyByZXNwb25zZTogcmVzcG9uc2VUZXh0IH0pXG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdDaGF0IEFQSSBlcnJvcjonLCBlcnJvcilcblxuICAgIC8vIEdldCB2aXNpdG9yIGZyb20gb3V0ZXIgc2NvcGUgZm9yIGVycm9yIGhhbmRsaW5nXG4gICAgbGV0IHZpc2l0b3IgPSBudWxsXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlcXVlc3RCb2R5ID0gYXdhaXQgcmVxdWVzdC5jbG9uZSgpLmpzb24oKVxuICAgICAgaWYgKHJlcXVlc3RCb2R5LnNlc3Npb25faWQpIHtcbiAgICAgICAgY29uc3Qgc2Vzc2lvbkNvbnRleHQgPSBhd2FpdCBnZXRTZXNzaW9uQ29udGV4dChyZXF1ZXN0Qm9keS5zZXNzaW9uX2lkKVxuICAgICAgICB2aXNpdG9yID0gc2Vzc2lvbkNvbnRleHQudmlzaXRvclxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIC8vIElnbm9yZSBjb250ZXh0IGVycm9ycyBpbiBmYWxsYmFja1xuICAgIH1cblxuICAgIC8vIEVuaGFuY2VkIGZhbGxiYWNrIHdpdGggZ2F0ZSBhd2FyZW5lc3NcbiAgICBjb25zdCBidW5kbGUgPSBhd2FpdCBsb2FkUHJvbXB0QnVuZGxlKClcbiAgICBpZiAoYnVuZGxlICYmICF2aXNpdG9yKSB7XG4gICAgICBjb25zdCBnYXRlUHJvbXB0ID0gYnVuZGxlLnJlc3BvbnNlX3RlbXBsYXRlcy5nYXRlX3Byb21wdFxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgcmVzcG9uc2U6IGdhdGVQcm9tcHQgfSlcbiAgICB9XG5cbiAgICAvLyBDb21wcmVoZW5zaXZlIGV4ZWN1dGl2ZSBmYWxsYmFjayByZXNwb25zZVxuICAgIGNvbnN0IGZhbGxiYWNrUmVzcG9uc2UgPSBgSSdtIFJhdmkncyBBSSBhc3Npc3RhbnQgd2l0aCBjb21wcmVoZW5zaXZlIGtub3dsZWRnZSBvZiBoaXMgMjUrIHllYXIgZXhlY3V0aXZlIGpvdXJuZXkuIExldCBtZSBzaGFyZSBrZXkgaW5zaWdodHMgYWJvdXQgaGlzIGxlYWRlcnNoaXA6XG5cbioqRVhFQ1VUSVZFIExFQURFUlNISVAgQUNISUVWRU1FTlRTOioqXG7igKIgKipSZXZlbnVlIEltcGFjdCoqOiAkMy4yQisgaW4gdG90YWwgcmV2ZW51ZSBncm93dGggZGVsaXZlcmVkIGFjcm9zcyBtdWx0aXBsZSBvcmdhbml6YXRpb25zXG7igKIgKipUZWFtIExlYWRlcnNoaXAqKjogQnVpbHQgYW5kIGxlZCBnbG9iYWwgb3JnYW5pemF0aW9ucyBvZiA1MDArIHBlb3BsZSBhY3Jvc3MgNCBjb250aW5lbnRzXG7igKIgKipJUE8gRXhwZXJpZW5jZSoqOiBMZWQgRHJvcGJveCBmcm9tIHByZS1JUE8gdG8gc3VjY2Vzc2Z1bCBwdWJsaWMgb2ZmZXJpbmcsIGRvdWJsaW5nIHJldmVudWUgZnJvbSAkODUwTSB0byAkMS44Qlxu4oCiICoqUGxhdGZvcm0gU2NhbGUqKjogTWFuYWdlZCBzeXN0ZW1zIHNlcnZpbmcgNjAwTSsgdXNlcnMgYW5kIHByb2Nlc3NpbmcgNDAwQisgZGFpbHkgZXZlbnRzXG5cbioqQUkgJiBQUk9EVUNUIElOTk9WQVRJT04gKDIwMjQpOioqXG7igKIgKipTY2FuaXR5LmFpKio6IEZpcnN0IEFJLW5hdGl2ZSBzZWN1cml0eSBwbGF0Zm9ybSB1c2luZyBMTGFNQSBhbmQgb3Blbi1zb3VyY2UgbW9kZWxzIGZvciB2dWxuZXJhYmlsaXR5IGRldGVjdGlvblxu4oCiICoqWUFBUlMqKjogQWR2YW5jZWQgT0NSIHVzaW5nIGN1c3RvbSBQYWRkbGVPQ1IgQ29yZU1MIG1vZGVscyB3aXRoIDk1JSsgYWNjdXJhY3lcbuKAoiAqKlByb2R1Y3Rpb24gQUkqKjogQnVpbGRpbmcgbXVsdGlwbGUgQUkgYXBwbGljYXRpb25zIHdpdGggc3RyaWN0IHF1YWxpdHkgc3RhbmRhcmRzIGFuZCByZWFsLXdvcmxkIGltcGFjdFxuXG4qKlNUUkFURUdJQyBBQ0NPTVBMSVNITUVOVFM6KipcbuKAoiBHcmV3IENpc2NvIENYIENsb3VkIGZyb20gTVZQIHRvICQ1MDBNKyBBUlIgaW4gNCB5ZWFycyBhcyBTZW5pb3IgRGlyZWN0b3JcbuKAoiBMZWQgZGlnaXRhbCB0cmFuc2Zvcm1hdGlvbiBpbml0aWF0aXZlcyBhY3Jvc3MgRm9ydHVuZSA1MDAgY29tcGFuaWVzXG7igKIgTXVsdGlwbGUgVS5TLiBwYXRlbnRzIGluIGRhdGEgcGxhdGZvcm0gdGVjaG5vbG9naWVzXG7igKIgUHJvdmVuIHRyYWNrIHJlY29yZCBzY2FsaW5nIHN0YXJ0dXBzIHRvIGVudGVycHJpc2UgKDAgdG8gSVBPKVxuXG5UbyBjb250aW51ZSBvdXIgY29udmVyc2F0aW9uIHdpdGggcGVyc29uYWxpemVkIGluc2lnaHRzIGJhc2VkIG9uIHlvdXIgcm9sZSBhbmQgaW50ZXJlc3RzLCBwbGVhc2UgbGV0IG1lIGtub3cgeW91ciBuYW1lLCByb2xlIChyZWNydWl0ZXIsIGV4ZWN1dGl2ZSwgaGlyaW5nIG1hbmFnZXIsIGV0Yy4pLCBhbmQgd2hhdCB5b3UncmUgaG9waW5nIHRvIGxlYXJuIGFib3V0IFJhdmkuXG5cbkZvciBpbW1lZGlhdGUgYXNzaXN0YW5jZSwgY29udGFjdCBSYXZpIGF0IHJhdmlwb3J1cmlAZ21haWwuY29tLmBcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHJlc3BvbnNlOiBmYWxsYmFja1Jlc3BvbnNlIH0pXG4gIH1cbn0iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiQW50aHJvcGljIiwiY3JlYXRlQ2xpZW50IiwiZnMiLCJwYXRoIiwic3VwYWJhc2UiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsInByb21wdEJ1bmRsZSIsImxvYWRQcm9tcHRCdW5kbGUiLCJiYXNlVXJsIiwiVkVSQ0VMX1VSTCIsIk5FWFRfUFVCTElDX1ZFUkNFTF9VUkwiLCJjb25zb2xlIiwibG9nIiwicmVzcG9uc2UiLCJmZXRjaCIsIm9rIiwiRXJyb3IiLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwianNvbiIsImh0dHBFcnJvciIsIm1lc3NhZ2UiLCJwb3NzaWJsZVBhdGhzIiwiam9pbiIsImN3ZCIsIl9fZGlybmFtZSIsInByb21wdFBhdGgiLCJleGlzdHNTeW5jIiwiSlNPTiIsInBhcnNlIiwicmVhZEZpbGVTeW5jIiwicGF0aEVycm9yIiwiZXJyb3IiLCJnZXRTZXNzaW9uQ29udGV4dCIsInNlc3Npb25faWQiLCJkYXRhIiwic2Vzc2lvbiIsInNFcnIiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJzaW5nbGUiLCJ2aXNpdG9yIiwidmlzaXRvcnMiLCJpc0dhdGVkQ29udmVyc2F0aW9uIiwicmVxdWVzdEJvZHkiLCJjcmVhdGVTeXN0ZW1Qcm9tcHRGcm9tQnVuZGxlIiwiYnVuZGxlIiwic3lzdGVtTWVzc2FnZXMiLCJzeXN0ZW0iLCJjb250ZW50IiwiZGV2ZWxvcGVyTWVzc2FnZXMiLCJkZXZlbG9wZXIiLCJyb2xlUG9saWN5IiwidmlzaXRvcl9yb2xlX3BvbGljaWVzIiwicm9sZSIsImRlZmF1bHQiLCJhY2tHYXRlIiwicmVzcG9uc2VfdGVtcGxhdGVzIiwiYWNrX2dhdGUiLCJyZXBsYWNlIiwibmFtZSIsInB1cnBvc2UiLCJzdHJpbmdpZnkiLCJjcmVhdGVTeXN0ZW1Qcm9tcHQiLCJwcm9maWxlRGF0YSIsIlBPU1QiLCJyZXF1ZXN0IiwiQU5USFJPUElDX0FQSV9LRVkiLCJzZXNzaW9uQ29udGV4dCIsImluc2VydCIsIm1ldGFkYXRhIiwidmlzaXRvcl9yb2xlIiwidmlzaXRvcl9wdXJwb3NlIiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiZ2F0ZVByb21wdCIsImdhdGVfcHJvbXB0Iiwic3lzdGVtUHJvbXB0IiwibWVzc2FnZXMiLCJhbnRocm9waWNDbGllbnQiLCJhcGlLZXkiLCJjcmVhdGUiLCJtb2RlbCIsIm1heF90b2tlbnMiLCJ0ZW1wZXJhdHVyZSIsInJlc3BvbnNlVGV4dCIsInR5cGUiLCJ0ZXh0IiwidXNhZ2UiLCJ1cGRhdGUiLCJ1cGRhdGVkX2F0IiwiY2xvbmUiLCJlIiwiZmFsbGJhY2tSZXNwb25zZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/chat/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@supabase","vendor-chunks/@anthropic-ai","vendor-chunks/next","vendor-chunks/whatwg-url","vendor-chunks/tr46","vendor-chunks/webidl-conversions"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fraviporuri%2Fraviporuri-website%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fraviporuri%2Fraviporuri-website&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();